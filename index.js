// Generated by CoffeeScript 1.10.0
var R, fs, get, getPreset, isThere, logUse, logger, nocomments, obtain, path, sourcegate, task;

require("source-map-support").install();

R = require("ramda");

fs = require("fs");

path = require("path");

isThere = require("is-there");

sourcegate = require("sourcegate");

nocomments = require("strip-json-comments");

task = require("be-goods").gulpTask;

logger = require("be-goods").logger;

logUse = function(what) {
  if (what == null) {
    what = "";
  }
  if (process.argv[2] === "sourcegate") {
    return console.log(what);
  }
};

obtain = function(somewhere) {
  return JSON.parse(nocomments(fs.readFileSync(path.normalize(somewhere)).toString()));
};

get = function(what, module) {
  var e, error, gotIt, i, j, last, ref, where;
  where = ["node_modules/" + what, "node_modules/" + module + "/node_modules/" + what, "node_modules/beverage/node_modules/" + module + "/node_modules/" + what];
  last = where.length - 1;
  for (i = j = 0, ref = last; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
    try {
      gotIt = obtain(where[i]);
      logUse("Source " + where[i]);
      return gotIt;
    } catch (error) {
      e = error;
      if (i === last) {
        logger.error(e);
        throw new Error("Could not find preset at: " + where);
      }
      continue;
    }
  }
};

getPreset = function(tool, name, module) {
  var presets, ref;
  presets = {
    jscs: "jscs/presets",
    jshint: {
      airbnb: "airbnb-style/linters/jshintrc"
    },
    eslint: {
      airbnb: "airbnb-style/linters/.eslintrc"
    },
    coffeelint: {
      "hal-coffeescript-style-guide": "hal-coffeescript-style-guide/coffeelint.json"
    }
  };
  if (tool === "jscs") {
    return get(presets.jscs + "/" + name + ".json", module);
  } else if (((ref = presets[tool]) != null ? ref[name] : void 0) != null) {
    return get(presets[tool][name], module);
  } else {
    return {};
  }
};

module.exports = function(o, gulp) {
  var base, config, empty, filerc, j, len, module, prefix, preset, ready, ref, res, sg, sources, watch;
  if (o == null) {
    o = {};
  }
  empty = [[], {}];
  if (R.is(Array, o.sourcegate)) {
    if (R.isEmpty(o.sourcegate)) {
      return [empty];
    }
  } else {
    return [empty];
  }
  if (o.sourceopt == null) {
    o.sourceopt = {};
  }
  ready = [];
  watch = [];
  ref = o.sourcegate;
  for (j = 0, len = ref.length; j < len; j++) {
    sg = ref[j];
    res = R.clone(empty);
    if (sg.options == null) {
      sg.options = {};
    }
    if (sg.recipe == null) {
      res = [sg.sources, sg.options];
    } else {
      logUse();
      logUse("For " + sg.recipe + ":");
      sources = [];
      module = sg.module || o.sourceopt.module;
      prefix = sg.prefix || o.sourceopt.prefix || '';
      preset = sg.preset || o.sourceopt.preset;
      if (preset != null) {
        sources.push(getPreset(sg.recipe, preset, module));
      }
      filerc = sg.recipe === "coffeelint" ? "coffeelint.json" : "." + sg.recipe + "rc";
      if ((module != null) && module !== '!') {
        config = "" + prefix + filerc;
        if (module) {
          config = "node_modules/" + module + "/" + config;
        }
        config = path.normalize(config);
        logUse("Source " + config);
        if (!isThere(config)) {
          logger.error("Could not find: " + config);
        } else {
          if (o.sourceopt.watch) {
            watch.push(config);
          }
          sources.push(config);
        }
      }
      if ((base = sg.options).write == null) {
        base.write = {};
      }
      sg.options.write.path = filerc;
      if (sg.sources != null) {
        sources = sources.concat(sg.sources);
      }
      res = [sources, sg.options];
    }
    ready.push(res);
  }
  if (gulp != null) {
    task(gulp, "sourcegate", "Write sourcegate targets.", function() {
      var k, len1, results;
      results = [];
      for (k = 0, len1 = ready.length; k < len1; k++) {
        sg = ready[k];
        results.push(sourcegate.apply(null, sg));
      }
      return results;
    });
    if (o.sourceopt.watch) {
      task(gulp, "sourcegate:watch", "Watch sourcegate sources for changes.", function() {
        return gulp.watch(watch, ["sourcegate"]);
      });
    }
  }
  logUse();
  return ready;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY29mZmVlIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW5kZXguY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBOztBQUFBLE9BQUEsQ0FBUSxvQkFBUixDQUE2QixDQUFDLE9BQTlCLENBQUE7O0FBQ0EsQ0FBQSxHQUFJLE9BQUEsQ0FBUSxPQUFSOztBQUNKLEVBQUEsR0FBSyxPQUFBLENBQVEsSUFBUjs7QUFDTCxJQUFBLEdBQU8sT0FBQSxDQUFRLE1BQVI7O0FBQ1AsT0FBQSxHQUFVLE9BQUEsQ0FBUSxVQUFSOztBQUNWLFVBQUEsR0FBYSxPQUFBLENBQVEsWUFBUjs7QUFDYixVQUFBLEdBQWEsT0FBQSxDQUFRLHFCQUFSOztBQUNiLElBQUEsR0FBTyxPQUFBLENBQVEsVUFBUixDQUFtQixDQUFDOztBQUMzQixNQUFBLEdBQVMsT0FBQSxDQUFRLFVBQVIsQ0FBbUIsQ0FBQzs7QUFFN0IsTUFBQSxHQUFTLFNBQUMsSUFBRDs7SUFBQyxPQUFPOztFQUFPLElBQW9CLE9BQU8sQ0FBQyxJQUFLLENBQUEsQ0FBQSxDQUFiLEtBQW1CLFlBQXZDO1dBQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxJQUFaLEVBQUE7O0FBQWY7O0FBRVQsTUFBQSxHQUFTLFNBQUMsU0FBRDtTQUNQLElBQUksQ0FBQyxLQUFMLENBQVcsVUFBQSxDQUFXLEVBQUUsQ0FBQyxZQUFILENBQWdCLElBQUksQ0FBQyxTQUFMLENBQWUsU0FBZixDQUFoQixDQUF5QyxDQUFDLFFBQTFDLENBQUEsQ0FBWCxDQUFYO0FBRE87O0FBR1QsR0FBQSxHQUFNLFNBQUMsSUFBRCxFQUFPLE1BQVA7QUFFSixNQUFBO0VBQUEsS0FBQSxHQUFRLENBQ04sZUFBQSxHQUFnQixJQURWLEVBRU4sZUFBQSxHQUFnQixNQUFoQixHQUF1QixnQkFBdkIsR0FBdUMsSUFGakMsRUFHTixxQ0FBQSxHQUFzQyxNQUF0QyxHQUE2QyxnQkFBN0MsR0FBNkQsSUFIdkQ7RUFNUixJQUFBLEdB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cmNlc0NvbnRlbnQiOlsicmVxdWlyZShcInNvdXJjZS1tYXAtc3VwcG9ydFwiKS5pbnN0YWxsKClcblIgPSByZXF1aXJlKFwicmFtZGFcIilcbmZzID0gcmVxdWlyZShcImZzXCIpXG5wYXRoID0gcmVxdWlyZShcInBhdGhcIilcbmlzVGhlcmUgPSByZXF1aXJlKFwiaXMtdGhlcmVcIilcbnNvdXJjZWdhdGUgPSByZXF1aXJlKFwic291cmNlZ2F0ZVwiKVxubm9jb21tZW50cyA9IHJlcXVpcmUoXCJzdHJpcC1qc29uLWNvbW1lbnRzXCIpXG50YXNrID0gcmVxdWlyZShcImJlLWdvb2RzXCIpLmd1bHBUYXNrXG5sb2dnZXIgPSByZXF1aXJlKFwiYmUtZ29vZHNcIikubG9nZ2VyXG5cbmxvZ1VzZSA9ICh3aGF0ID0gXCJcIikgLT4gY29uc29sZS5sb2cgd2hhdCBpZiBwcm9jZXNzLmFyZ3ZbMl0gaXMgXCJzb3VyY2VnYXRlXCJcblxub2J0YWluID0gKHNvbWV3aGVyZSkgLT5cbiAgSlNPTi5wYXJzZSBub2NvbW1lbnRzIGZzLnJlYWRGaWxlU3luYyhwYXRoLm5vcm1hbGl6ZSBzb21ld2hlcmUpLnRvU3RyaW5nKClcblxuZ2V0ID0gKHdoYXQsIG1vZHVsZSkgLT5cbiAgIyBndXRpbC5sb2cgXCJMb29raW5nIGZvciAnI3t3aGF0fScgaW4gbW9kdWxlICcje21vZHVsZX0nXCJcbiAgd2hlcmUgPSBbXG4gICAgXCJub2RlX21vZHVsZXMvI3t3aGF0fVwiLFxuICAgIFwibm9kZV9tb2R1bGVzLyN7bW9kdWxlfS9ub2RlX21vZHVsZXMvI3t3aGF0fVwiLFxuICAgIFwibm9kZV9tb2R1bGVzL2JldmVyYWdlL25vZGVfbW9kdWxlcy8je21vZHVsZX0vbm9kZV9tb2R1bGVzLyN7d2hhdH1cIlxuICBdXG5cbiAgbGFzdCA9IHdoZXJlLmxlbmd0aCAtIDFcbiAgZm9yIGkgaW4gWzAuLmxhc3RdXG4gICAgdHJ5XG4gICAgICBnb3RJdCA9IG9idGFpbiB3aGVyZVtpXVxuICAgICAgbG9nVXNlIFwiU291cmNlICN7d2hlcmVbaV19XCJcbiAgICAgIHJldHVybiBnb3RJdFxuICAgIGNhdGNoIGVcbiAgICAgIGlmIGkgaXMgbGFzdFxuICAgICAgICBsb2dnZXIuZXJyb3IoZSlcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yIFwiQ291bGQgbm90IGZpbmQgcHJlc2V0IGF0OiAje3doZXJlfVwiXG4gICAgICBjb250aW51ZVxuXG5cbmdldFByZXNldCA9ICh0b29sLCBuYW1lLCBtb2R1bGUpIC0+XG4gICMgdGhlIHRvb2wgaXMga25vd24gYXMgcmVjaXBlXG4gICMgdGhlIG5hbWUgaXMga25vd24gYXMgcHJlc2V0XG4gIHByZXNldHMgPVxuICAgIGpzY3M6IFwianNjcy9wcmVzZXRzXCIgI3twcmVzZXR9Lmpzb24gd2lsbCBiZSBhcHBlbmRlZFxuICAgIGpzaGludDpcbiAgICAgIGFpcmJuYjogXCJhaXJibmItc3R5bGUvbGludGVycy9qc2hpbnRyY1wiXG4gICAgZXNsaW50OlxuICAgICAgYWlyYm5iOiBcImFpcmJuYi1zdHlsZS9saW50ZXJzLy5lc2xpbnRyY1wiXG4gICAgY29mZmVlbGludDpcbiAgICAgIFwiaGFsLWNvZmZlZXNjcmlwdC1zdHlsZS1ndWlkZVwiOiBcImhhbC1jb2ZmZWVzY3JpcHQtc3R5bGUtZ3VpZGUvY29mZmVlbGludC5qc29uXCJcblxuICBpZiB0b29sIGlzIFwianNjc1wiXG4gICAgZ2V0KFwiI3twcmVzZXRzLmpzY3N9LyN7bmFtZX0uanNvblwiLCBtb2R1bGUpXG4gIGVsc2UgaWYgcHJlc2V0c1t0b29sXT9bbmFtZV0/XG4gICAgZ2V0KHByZXNldHNbdG9vbF1bbmFtZV0sIG1vZHVsZSlcbiAgZWxzZSB7fVxuXG5cbm1vZHVsZS5leHBvcnRzID0gKG8gPSB7fSwgZ3VscCkgLT5cbiAgZW1wdHkgPSBbW10sIHt9XVxuICBpZiBSLmlzKEFycmF5LCBvLnNvdXJjZWdhdGUpXG4gICAgaWYgUi5pc0VtcHR5KG8uc291cmNlZ2F0ZSkgdGhlbiByZXR1cm4gW2VtcHR5XVxuICBlbHNlIHJldHVybiBbZW1wdHldICMgb3IgdGhyb3c/XG4gIG8uc291cmNlb3B0ID89IHt9XG4gIHJlYWR5ID0gW11cbiAgd2F0Y2ggPSBbXVxuXG4gIGZvciBzZyBpbiBvLnNvdXJjZWdhdGVcbiAgICByZXMgPSBSLmNsb25lKGVtcHR5KVxuICAgIHNnLm9wdGlvbnMgPz0ge31cblxuICAgIHVubGVzcyBzZy5yZWNpcGU/XG4gICAgICAjIDAuIHdpdGhvdXQgYSByZWNpcGUsIGhhbC1yYyBqdXN0IGhhbmRzIHNvdXJjZXMgYW5kIG9wdGlvbnMgdG8gc291cmNlZ2F0ZVxuICAgICAgcmVzID0gW3NnLnNvdXJjZXMsIHNnLm9wdGlvbnNdXG4gICAgZWxzZVxuICAgICAgbG9nVXNlKClcbiAgICAgIGxvZ1VzZShcIkZvciAje3NnLnJlY2lwZX06XCIpXG4gICAgICBzb3VyY2VzID0gW11cbiAgICAgIG1vZHVsZSA9IHNnLm1vZHVsZSBvciBvLnNvdXJjZW9wdC5tb2R1bGVcbiAgICAgIHByZWZpeCA9IHNnLnByZWZpeCBvciBvLnNvdXJjZW9wdC5wcmVmaXggb3IgJydcbiAgICAgIHByZXNldCA9IHNnLnByZXNldCBvciBvLnNvdXJjZW9wdC5wcmVzZXRcbiAgICAgICMgMS4gc3RhcnQgd2l0aCBwcmVzZXQgKHNvbWV0aGluZyBrbm93biAvIHN0YW5kYXJkKVxuICAgICAgaWYgcHJlc2V0P1xuICAgICAgICBzb3VyY2VzLnB1c2ggZ2V0UHJlc2V0KHNnLnJlY2lwZSwgcHJlc2V0LCBtb2R1bGUpXG4gICAgICBmaWxlcmMgPSBpZiBzZy5yZWNpcGUgaXMgXCJjb2ZmZWVsaW50XCIgdGhlbiBcImNvZmZlZWxpbnQuanNvblwiIGVsc2UgXCIuI3tzZy5yZWNpcGV9cmNcIlxuICAgICAgaWYgbW9kdWxlPyAmJiBtb2R1bGUgaXNudCAnISdcbiAgICAgICAgIyAyLiBvdmVycmlkZSB3aXRoIGEgbW9kdWxlIGNvbmZpZyAoYW55Ym9keSBjYW4gaGF2ZSBwcmVzZXRzKVxuICAgICAgICAjIGBtb2R1bGUgaXMgZmFsc2VgIG1lYW5zIGhhbC1yYydzIGRlZmF1bHRzIHdpbGwgYmUgdXNlZFxuICAgICAgICAjIGBtb2R1bGUgaXMgJyEnYCB3b3VsZCBmYXZvciB0aGUgcHJlc2V0ICsgbG9jYWwgbm9uLW1vZHVsZSBvdmVycmlkZXNcbiAgICAgICAgY29uZmlnID0gXCIje3ByZWZpeH0je2ZpbGVyY31cIlxuICAgICAgICBpZiBtb2R1bGVcbiAgICAgICAgICBjb25maWcgPSBcIm5vZGVfbW9kdWxlcy8je21vZHVsZX0vI3tjb25maWd9XCJcbiAgICAgICAgY29uZmlnID0gcGF0aC5ub3JtYWxpemUoY29uZmlnKVxuICAgICAgICBsb2dVc2UgXCJTb3VyY2UgI3tjb25maWd9XCJcblxuICAgICAgICB1bmxlc3MgaXNUaGVyZSBjb25maWdcbiAgICAgICAgICBsb2dnZXIuZXJyb3IgXCJDb3VsZCBub3QgZmluZDogI3tjb25maWd9XCJcbiAgICAgICAgZWxzZVxuICAgICAgICAgIGlmIG8uc291cmNlb3B0LndhdGNoXG4gICAgICAgICAgICB3YXRjaC5wdXNoIGNvbmZpZ1xuICAgICAgICAgIHNvdXJjZXMucHVzaCBjb25maWdcbiAgICAgIHNnLm9wdGlvbnMud3JpdGUgPz0ge31cbiAgICAgIHNnLm9wdGlvbnMud3JpdGUucGF0aCA9IGZpbGVyY1xuICAgICAgIyAzLiBzb3VyY2VzLCB3aGV0aGVyIGFuIG9iamVjdCBvciBhcnJheSwgYmVjb21lIHRoZSBmaW5hbCBvdmVycmlkZVxuICAgICAgc291cmNlcyA9IHNvdXJjZXMuY29uY2F0KHNnLnNvdXJjZXMpIGlmIHNnLnNvdXJjZXM/XG4gICAgICByZXMgPSBbc291cmNlcywgc2cub3B0aW9uc11cblxuICAgIHJlYWR5LnB1c2ggcmVzXG5cbiAgIyBvcHRpb25hbCBndWxwIC8gdGFza3NcbiAgaWYgZ3VscD9cbiAgICB0YXNrIGd1bHAsIFwic291cmNlZ2F0ZVwiLCBcIldyaXRlIHNvdXJjZWdhdGUgdGFyZ2V0cy5cIiwgLT5cbiAgICAgIGZvciBzZyBpbiByZWFkeVxuICAgICAgICBzb3VyY2VnYXRlLmFwcGx5KG51bGwsIHNnKVxuICAgIGlmIG8uc291cmNlb3B0LndhdGNoXG4gICAgICB0YXNrIGd1bHAsIFwic291cmNlZ2F0ZTp3YXRjaFwiLFxuICAgICAgICBcIldhdGNoIHNvdXJjZWdhdGUgc291cmNlcyBmb3IgY2hhbmdlcy5cIiwgLT5cbiAgICAgICAgICBndWxwLndhdGNoIHdhdGNoLCBbXCJzb3VyY2VnYXRlXCJdXG5cbiAgbG9nVXNlKClcbiAgcmVhZHlcbiJdfQ==