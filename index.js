// Generated by CoffeeScript 1.10.0
var R, fs, get, getPreset, isThere, logUse, logger, nocomments, obtain, path, sourcegate, task;

require("source-map-support").install();

R = require("ramda");

fs = require("fs");

path = require("path");

isThere = require("is-there");

sourcegate = require("sourcegate");

nocomments = require("strip-json-comments");

task = require("be-goods").gulpTask;

logger = require("be-goods").logger;

logUse = function(what) {
  if (what == null) {
    what = "";
  }
  if (process.argv[2] === "sourcegate") {
    return console.log(what);
  }
};

obtain = function(somewhere) {
  return JSON.parse(nocomments(fs.readFileSync(path.normalize(somewhere)).toString()));
};

get = function(what, module) {
  var e, error, gotIt, i, j, last, ref, where;
  where = ["node_modules/" + what, "node_modules/" + module + "/node_modules/" + what, "node_modules/beverage/node_modules/" + module + "/node_modules/" + what, "node_modules/beverage/node_modules/hal-rc/node_modules/" + what];
  last = where.length - 1;
  for (i = j = 0, ref = last; 0 <= ref ? j <= ref : j >= ref; i = 0 <= ref ? ++j : --j) {
    try {
      gotIt = obtain(where[i]);
      logUse("Source " + where[i]);
      return gotIt;
    } catch (error) {
      e = error;
      if (i === last) {
        logger.error(e);
        throw new Error("Could not find preset at: " + where);
      }
      continue;
    }
  }
};

getPreset = function(tool, name, module) {
  var presets, ref;
  presets = {
    jscs: "jscs/presets",
    jshint: {
      airbnb: "airbnb-style/linters/jshintrc"
    },
    eslint: {
      airbnb: "airbnb-style/linters/.eslintrc"
    },
    coffeelint: {
      "hal-coffeescript-style-guide": "hal-coffeescript-style-guide/coffeelint.json"
    }
  };
  if (tool === "jscs") {
    return get(presets.jscs + "/" + name + ".json", module);
  } else if (((ref = presets[tool]) != null ? ref[name] : void 0) != null) {
    return get(presets[tool][name], module);
  } else {
    return {};
  }
};

module.exports = function(o, gulp) {
  var base, config, empty, filerc, j, len, module, prefix, preset, ready, ref, res, sg, sources, watch;
  if (o == null) {
    o = {};
  }
  empty = [[], {}];
  if (R.is(Array, o.sourcegate)) {
    if (R.isEmpty(o.sourcegate)) {
      return [empty];
    }
  } else {
    return [empty];
  }
  if (o.sourceopt == null) {
    o.sourceopt = {};
  }
  ready = [];
  watch = [];
  ref = o.sourcegate;
  for (j = 0, len = ref.length; j < len; j++) {
    sg = ref[j];
    res = R.clone(empty);
    if (sg.options == null) {
      sg.options = {};
    }
    if (sg.recipe == null) {
      res = [sg.sources, sg.options];
    } else {
      logUse();
      logUse("For " + sg.recipe + ":");
      sources = [];
      module = sg.module || o.sourceopt.module;
      prefix = sg.prefix || o.sourceopt.prefix || '';
      preset = sg.preset || o.sourceopt.preset;
      if (preset != null) {
        sources.push(getPreset(sg.recipe, preset, module));
      }
      filerc = sg.recipe === "coffeelint" ? "coffeelint.json" : "." + sg.recipe + "rc";
      if ((module != null) && module !== '!') {
        config = "" + prefix + filerc;
        if (module) {
          config = "node_modules/" + module + "/" + config;
        }
        config = path.normalize(config);
        logUse("Source " + config);
        if (!isThere(config)) {
          logger.error("Could not find: " + config);
        } else {
          if (o.sourceopt.watch) {
            watch.push(config);
          }
          sources.push(config);
        }
      }
      if ((base = sg.options).write == null) {
        base.write = {};
      }
      sg.options.write.path = filerc;
      if (sg.sources != null) {
        sources = sources.concat(sg.sources);
      }
      res = [sources, sg.options];
    }
    ready.push(res);
  }
  if (gulp != null) {
    task(gulp, "sourcegate", "Write sourcegate targets.", function() {
      var k, len1, results;
      results = [];
      for (k = 0, len1 = ready.length; k < len1; k++) {
        sg = ready[k];
        results.push(sourcegate.apply(null, sg));
      }
      return results;
    });
    if (o.sourceopt.watch) {
      task(gulp, "sourcegate:watch", "Watch sourcegate sources for changes.", function() {
        return gulp.watch(watch, ["sourcegate"]);
      });
    }
  }
  logUse();
  return ready;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguY29mZmVlIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW5kZXguY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBOztBQUFBLE9BQUEsQ0FBUSxvQkFBUixDQUE2QixDQUFDLE9BQTlCLENBQUE7O0FBQ0EsQ0FBQSxHQUFJLE9BQUEsQ0FBUSxPQUFSOztBQUNKLEVBQUEsR0FBSyxPQUFBLENBQVEsSUFBUjs7QUFDTCxJQUFBLEdBQU8sT0FBQSxDQUFRLE1BQVI7O0FBQ1AsT0FBQSxHQUFVLE9BQUEsQ0FBUSxVQUFSOztBQUNWLFVBQUEsR0FBYSxPQUFBLENBQVEsWUFBUjs7QUFDYixVQUFBLEdBQWEsT0FBQSxDQUFRLHFCQUFSOztBQUNiLElBQUEsR0FBTyxPQUFBLENBQVEsVUFBUixDQUFtQixDQUFDOztBQUMzQixNQUFBLEdBQVMsT0FBQSxDQUFRLFVBQVIsQ0FBbUIsQ0FBQzs7QUFFN0IsTUFBQSxHQUFTLFNBQUMsSUFBRDs7SUFBQyxPQUFPOztFQUFPLElBQW9CLE9BQU8sQ0FBQyxJQUFLLENBQUEsQ0FBQSxDQUFiLEtBQW1CLFlBQXZDO1dBQUEsT0FBTyxDQUFDLEdBQVIsQ0FBWSxJQUFaLEVBQUE7O0FBQWY7O0FBRVQsTUFBQSxHQUFTLFNBQUMsU0FBRDtTQUNQLElBQUksQ0FBQyxLQUFMLENBQVcsVUFBQSxDQUFXLEVBQUUsQ0FBQyxZQUFILENBQWdCLElBQUksQ0FBQyxTQUFMLENBQWUsU0FBZixDQUFoQixDQUF5QyxDQUFDLFFBQTFDLENBQUEsQ0FBWCxDQUFYO0FBRE87O0FBR1QsR0FBQSxHQUFNLFNBQUMsSUFBRCxFQUFPLE1BQVA7QUFFSixNQUFBO0VBQUEsS0FBQSxHQUFRLENBQ04sZUFBQSxHQUFnQixJQURWLEVBRU4sZUFBQSxHQUFnQixNQUFoQixHQUF1QixnQkFBdkIsR0FBdUMsSUFGakMsRUFHTixxQ0FBQSxHQUFzQyxNQUF0QyxHQUE2QyxnQkFBN0MsR0FBNkQsSUFIdkQsRUFJTix5REFBQSxH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QSxDQUFBO1NBQ0E7QUE5RGUiLCJzb3VyY2VzQ29udGVudCI6WyJyZXF1aXJlKFwic291cmNlLW1hcC1zdXBwb3J0XCIpLmluc3RhbGwoKVxuUiA9IHJlcXVpcmUoXCJyYW1kYVwiKVxuZnMgPSByZXF1aXJlKFwiZnNcIilcbnBhdGggPSByZXF1aXJlKFwicGF0aFwiKVxuaXNUaGVyZSA9IHJlcXVpcmUoXCJpcy10aGVyZVwiKVxuc291cmNlZ2F0ZSA9IHJlcXVpcmUoXCJzb3VyY2VnYXRlXCIpXG5ub2NvbW1lbnRzID0gcmVxdWlyZShcInN0cmlwLWpzb24tY29tbWVudHNcIilcbnRhc2sgPSByZXF1aXJlKFwiYmUtZ29vZHNcIikuZ3VscFRhc2tcbmxvZ2dlciA9IHJlcXVpcmUoXCJiZS1nb29kc1wiKS5sb2dnZXJcblxubG9nVXNlID0gKHdoYXQgPSBcIlwiKSAtPiBjb25zb2xlLmxvZyB3aGF0IGlmIHByb2Nlc3MuYXJndlsyXSBpcyBcInNvdXJjZWdhdGVcIlxuXG5vYnRhaW4gPSAoc29tZXdoZXJlKSAtPlxuICBKU09OLnBhcnNlIG5vY29tbWVudHMgZnMucmVhZEZpbGVTeW5jKHBhdGgubm9ybWFsaXplIHNvbWV3aGVyZSkudG9TdHJpbmcoKVxuXG5nZXQgPSAod2hhdCwgbW9kdWxlKSAtPlxuICAjIGd1dGlsLmxvZyBcIkxvb2tpbmcgZm9yICcje3doYXR9JyBpbiBtb2R1bGUgJyN7bW9kdWxlfSdcIlxuICB3aGVyZSA9IFtcbiAgICBcIm5vZGVfbW9kdWxlcy8je3doYXR9XCIsXG4gICAgXCJub2RlX21vZHVsZXMvI3ttb2R1bGV9L25vZGVfbW9kdWxlcy8je3doYXR9XCIsXG4gICAgXCJub2RlX21vZHVsZXMvYmV2ZXJhZ2Uvbm9kZV9tb2R1bGVzLyN7bW9kdWxlfS9ub2RlX21vZHVsZXMvI3t3aGF0fVwiXG4gICAgXCJub2RlX21vZHVsZXMvYmV2ZXJhZ2Uvbm9kZV9tb2R1bGVzL2hhbC1yYy9ub2RlX21vZHVsZXMvI3t3aGF0fVwiXG4gIF1cblxuICBsYXN0ID0gd2hlcmUubGVuZ3RoIC0gMVxuICBmb3IgaSBpbiBbMC4ubGFzdF1cbiAgICB0cnlcbiAgICAgIGdvdEl0ID0gb2J0YWluIHdoZXJlW2ldXG4gICAgICBsb2dVc2UgXCJTb3VyY2UgI3t3aGVyZVtpXX1cIlxuICAgICAgcmV0dXJuIGdvdEl0XG4gICAgY2F0Y2ggZVxuICAgICAgaWYgaSBpcyBsYXN0XG4gICAgICAgIGxvZ2dlci5lcnJvcihlKVxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IgXCJDb3VsZCBub3QgZmluZCBwcmVzZXQgYXQ6ICN7d2hlcmV9XCJcbiAgICAgIGNvbnRpbnVlXG5cblxuZ2V0UHJlc2V0ID0gKHRvb2wsIG5hbWUsIG1vZHVsZSkgLT5cbiAgIyB0aGUgdG9vbCBpcyBrbm93biBhcyByZWNpcGVcbiAgIyB0aGUgbmFtZSBpcyBrbm93biBhcyBwcmVzZXRcbiAgcHJlc2V0cyA9XG4gICAganNjczogXCJqc2NzL3ByZXNldHNcIiAje3ByZXNldH0uanNvbiB3aWxsIGJlIGFwcGVuZGVkXG4gICAganNoaW50OlxuICAgICAgYWlyYm5iOiBcImFpcmJuYi1zdHlsZS9saW50ZXJzL2pzaGludHJjXCJcbiAgICBlc2xpbnQ6XG4gICAgICBhaXJibmI6IFwiYWlyYm5iLXN0eWxlL2xpbnRlcnMvLmVzbGludHJjXCJcbiAgICBjb2ZmZWVsaW50OlxuICAgICAgXCJoYWwtY29mZmVlc2NyaXB0LXN0eWxlLWd1aWRlXCI6IFwiaGFsLWNvZmZlZXNjcmlwdC1zdHlsZS1ndWlkZS9jb2ZmZWVsaW50Lmpzb25cIlxuXG4gIGlmIHRvb2wgaXMgXCJqc2NzXCJcbiAgICBnZXQoXCIje3ByZXNldHMuanNjc30vI3tuYW1lfS5qc29uXCIsIG1vZHVsZSlcbiAgZWxzZSBpZiBwcmVzZXRzW3Rvb2xdP1tuYW1lXT9cbiAgICBnZXQocHJlc2V0c1t0b29sXVtuYW1lXSwgbW9kdWxlKVxuICBlbHNlIHt9XG5cblxubW9kdWxlLmV4cG9ydHMgPSAobyA9IHt9LCBndWxwKSAtPlxuICBlbXB0eSA9IFtbXSwge31dXG4gIGlmIFIuaXMoQXJyYXksIG8uc291cmNlZ2F0ZSlcbiAgICBpZiBSLmlzRW1wdHkoby5zb3VyY2VnYXRlKSB0aGVuIHJldHVybiBbZW1wdHldXG4gIGVsc2UgcmV0dXJuIFtlbXB0eV0gIyBvciB0aHJvdz9cbiAgby5zb3VyY2VvcHQgPz0ge31cbiAgcmVhZHkgPSBbXVxuICB3YXRjaCA9IFtdXG5cbiAgZm9yIHNnIGluIG8uc291cmNlZ2F0ZVxuICAgIHJlcyA9IFIuY2xvbmUoZW1wdHkpXG4gICAgc2cub3B0aW9ucyA/PSB7fVxuXG4gICAgdW5sZXNzIHNnLnJlY2lwZT9cbiAgICAgICMgMC4gd2l0aG91dCBhIHJlY2lwZSwgaGFsLXJjIGp1c3QgaGFuZHMgc291cmNlcyBhbmQgb3B0aW9ucyB0byBzb3VyY2VnYXRlXG4gICAgICByZXMgPSBbc2cuc291cmNlcywgc2cub3B0aW9uc11cbiAgICBlbHNlXG4gICAgICBsb2dVc2UoKVxuICAgICAgbG9nVXNlKFwiRm9yICN7c2cucmVjaXBlfTpcIilcbiAgICAgIHNvdXJjZXMgPSBbXVxuICAgICAgbW9kdWxlID0gc2cubW9kdWxlIG9yIG8uc291cmNlb3B0Lm1vZHVsZVxuICAgICAgcHJlZml4ID0gc2cucHJlZml4IG9yIG8uc291cmNlb3B0LnByZWZpeCBvciAnJ1xuICAgICAgcHJlc2V0ID0gc2cucHJlc2V0IG9yIG8uc291cmNlb3B0LnByZXNldFxuICAgICAgIyAxLiBzdGFydCB3aXRoIHByZXNldCAoc29tZXRoaW5nIGtub3duIC8gc3RhbmRhcmQpXG4gICAgICBpZiBwcmVzZXQ/XG4gICAgICAgIHNvdXJjZXMucHVzaCBnZXRQcmVzZXQoc2cucmVjaXBlLCBwcmVzZXQsIG1vZHVsZSlcbiAgICAgIGZpbGVyYyA9IGlmIHNnLnJlY2lwZSBpcyBcImNvZmZlZWxpbnRcIiB0aGVuIFwiY29mZmVlbGludC5qc29uXCIgZWxzZSBcIi4je3NnLnJlY2lwZX1yY1wiXG4gICAgICBpZiBtb2R1bGU/ICYmIG1vZHVsZSBpc250ICchJ1xuICAgICAgICAjIDIuIG92ZXJyaWRlIHdpdGggYSBtb2R1bGUgY29uZmlnIChhbnlib2R5IGNhbiBoYXZlIHByZXNldHMpXG4gICAgICAgICMgYG1vZHVsZSBpcyBmYWxzZWAgbWVhbnMgaGFsLXJjJ3MgZGVmYXVsdHMgd2lsbCBiZSB1c2VkXG4gICAgICAgICMgYG1vZHVsZSBpcyAnISdgIHdvdWxkIGZhdm9yIHRoZSBwcmVzZXQgKyBsb2NhbCBub24tbW9kdWxlIG92ZXJyaWRlc1xuICAgICAgICBjb25maWcgPSBcIiN7cHJlZml4fSN7ZmlsZXJjfVwiXG4gICAgICAgIGlmIG1vZHVsZVxuICAgICAgICAgIGNvbmZpZyA9IFwibm9kZV9tb2R1bGVzLyN7bW9kdWxlfS8je2NvbmZpZ31cIlxuICAgICAgICBjb25maWcgPSBwYXRoLm5vcm1hbGl6ZShjb25maWcpXG4gICAgICAgIGxvZ1VzZSBcIlNvdXJjZSAje2NvbmZpZ31cIlxuXG4gICAgICAgIHVubGVzcyBpc1RoZXJlIGNvbmZpZ1xuICAgICAgICAgIGxvZ2dlci5lcnJvciBcIkNvdWxkIG5vdCBmaW5kOiAje2NvbmZpZ31cIlxuICAgICAgICBlbHNlXG4gICAgICAgICAgaWYgby5zb3VyY2VvcHQud2F0Y2hcbiAgICAgICAgICAgIHdhdGNoLnB1c2ggY29uZmlnXG4gICAgICAgICAgc291cmNlcy5wdXNoIGNvbmZpZ1xuICAgICAgc2cub3B0aW9ucy53cml0ZSA/PSB7fVxuICAgICAgc2cub3B0aW9ucy53cml0ZS5wYXRoID0gZmlsZXJjXG4gICAgICAjIDMuIHNvdXJjZXMsIHdoZXRoZXIgYW4gb2JqZWN0IG9yIGFycmF5LCBiZWNvbWUgdGhlIGZpbmFsIG92ZXJyaWRlXG4gICAgICBzb3VyY2VzID0gc291cmNlcy5jb25jYXQoc2cuc291cmNlcykgaWYgc2cuc291cmNlcz9cbiAgICAgIHJlcyA9IFtzb3VyY2VzLCBzZy5vcHRpb25zXVxuXG4gICAgcmVhZHkucHVzaCByZXNcblxuICAjIG9wdGlvbmFsIGd1bHAgLyB0YXNrc1xuICBpZiBndWxwP1xuICAgIHRhc2sgZ3VscCwgXCJzb3VyY2VnYXRlXCIsIFwiV3JpdGUgc291cmNlZ2F0ZSB0YXJnZXRzLlwiLCAtPlxuICAgICAgZm9yIHNnIGluIHJlYWR5XG4gICAgICAgIHNvdXJjZWdhdGUuYXBwbHkobnVsbCwgc2cpXG4gICAgaWYgby5zb3VyY2VvcHQud2F0Y2hcbiAgICAgIHRhc2sgZ3VscCwgXCJzb3VyY2VnYXRlOndhdGNoXCIsXG4gICAgICAgIFwiV2F0Y2ggc291cmNlZ2F0ZSBzb3VyY2VzIGZvciBjaGFuZ2VzLlwiLCAtPlxuICAgICAgICAgIGd1bHAud2F0Y2ggd2F0Y2gsIFtcInNvdXJjZWdhdGVcIl1cblxuICBsb2dVc2UoKVxuICByZWFkeVxuIl19